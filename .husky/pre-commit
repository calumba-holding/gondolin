#!/bin/sh

# Capture staged files before running checks
STAGED_FILES=$(git diff --cached --name-only)

make fix

# Restage files that were fixed
for file in $STAGED_FILES; do
  if [ -f "$file" ]; then
    git add "$file"
  fi
done

make check
if [ $? -ne 0 ]; then
  exit 1
fi
